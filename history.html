<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÇ‡∏û‡∏™‡∏ï‡πå</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#111;
  color:white;
}
.header{
  padding:15px;
  background:#222;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.back{
  background:#444;
  padding:6px 15px;
  border-radius:8px;
  text-decoration:none;
  color:white;
}
.section-title{
  font-size:20px;
  margin:15px 0 8px 0;
}
.list{
  padding:20px;
}
.item{
  background:#1d1d1d;
  padding:15px;
  border-radius:12px;
  margin-bottom:12px;
}
.tag{
  display:inline-block;
  padding:4px 10px;
  border-radius:8px;
  background:#00b894;
  margin-bottom:8px;
}
.btn{
  padding:6px 12px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  margin-right:6px;
}
.view{ background:#0984e3; color:white; }
.del{ background:#d63031; color:white; }
</style>
</head>

<body>

<div class="header">
  <a href="system.php" class="back">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</a>
  <h2>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÇ‡∏û‡∏™‡∏ï‡πå</h2>
</div>

<div class="list">

  <div class="section-title">üì¢ ‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£</div>
  <div id="newsBox"></div>

  <div class="section-title">‚≠ê ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</div>
  <div id="recBox"></div>

</div>

<script>
function load(){

  /* ---------- ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ---------- */
  let newsPosts = JSON.parse(localStorage.getItem("posts")) || [];
  let recPosts  = JSON.parse(localStorage.getItem("postser")) || [];

  let newsBox = document.getElementById("newsBox");
  let recBox  = document.getElementById("recBox");

  /* ---------- ‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£ ---------- */
  newsBox.innerHTML = newsPosts.length === 0
    ? "<p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£</p>"
    : newsPosts.map((p,i)=>`
      <div class="item">
        <div class="tag">‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£</div>

        <div>${(p.summary || "").substring(0,70)}...</div>

        <br>
        <button class="btn view" onclick="viewNews(${i})">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
        <button class="btn del" onclick="deleteNews(${i})">‡∏•‡∏ö</button>
      </div>
    `).join("");

  /* ---------- ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ---------- */
  recBox.innerHTML = recPosts.length === 0
    ? "<p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</p>"
    : recPosts.map((p,i)=>`
      <div class="item">
        <div class="tag">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</div>

        <div>${(p.summary || "").substring(0,70)}...</div>

        <br>
        <button class="btn view" onclick="viewRec(${i})">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
        <button class="btn del" onclick="deleteRec(${i})">‡∏•‡∏ö</button>
      </div>
    `).join("");
}

/* ---------------- ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ---------------- */
function viewNews(i){
  localStorage.setItem("view_post_index", i);
  location.href = "post_view.html?id="+i;
}

function viewRec(i){
  localStorage.setItem("view_post_index", i);
  location.href = "recomend/postser.html?id="+i;
}

/* ---------------- ‡∏•‡∏ö ---------------- */
function deleteNews(i){
  if(!confirm("‡∏•‡∏ö‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ ?")) return;
  let news = JSON.parse(localStorage.getItem("posts")) || [];
  news.splice(i,1);
  localStorage.setItem("posts", JSON.stringify(news));
  load();
}

function deleteRec(i){
  if(!confirm("‡∏•‡∏ö‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ô‡∏µ‡πâ ?")) return;
  let rec = JSON.parse(localStorage.getItem("postser")) || [];
  rec.splice(i,1);
  localStorage.setItem("postser", JSON.stringify(rec));
  load();
}

load();
</script>

</body>
</html>
